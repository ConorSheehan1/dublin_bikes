<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Hello</title>

    <link href='https://fonts.googleapis.com/css?family=Hind' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/static/css/main.css" />
    <link rel="stylesheet" href="/static/normalise.css" />

    <script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAX1jmcW1cZiqkj3sK8ICOzqkTCl7lp7yg&callback=initialise" type="text/javascript"></script>
    <script src="/static/superagent/superagent.js"></script>
    <script src="/static/js/handlebars/dist/handlebars.runtime.js"></script>
    <script src="/static/js/templates.js"></script>
    <script src="/static/js/helpers.js"></script>
    <script src="/static/js/Timer.js"></script>
    <script src="/static/js/CacheModule.js"></script>
    <script src="/static/js/BikesModule.js"></script>
    <script src="/static/js/PageModule.js"></script>
    <script src="/static/js/MapsModule.js"></script>
    <!--<script src="/static/bower_components/Chart.js/dist/Chart.min.js"></script>-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<body>

    <script type="text/javascript">
        // initialise the application
        var initialise = function () {
            MapsModule.init(document.getElementById("map"));
        }
        BikesModule.getStationHistoricalInformation({{ Data.number }}, null, function(err, response){
            console.log(response);
        });

        // window.addEventListener('popstate', function(e) {
        //   var state = PageModule.getState();
        //   console.log(state);
        //   if (state) {
        //     PageModule.gotoPage(state);
        //     PageModule.setState(history.state);
        //   } else {
        //     if (history.state) {
        //       console.log(history.state);
        //       PageModule.gotoPage(history.state);
        //     }
        //   }

        // });

        history.pushState(null, null, window.location.pathname);
    </script>

    <header>
    	<div>
        	<h1>Dublin Bikes</h1>
        </div>
            <img id="logo" src="../static/images/logo-cropped.png">
    </header>

    <div id="wrapper" class="m-wrapper">
        <div id="map" class="mapping">
            <!-- map goes here -->
        </div>
    </div>
    <div class="container">
        <div id="leftHeader">
            <h2>Station number</h2>
            <h3>Live data</h3>
            <ul>
                <li> total</li>
                {# <li id=statVariable> {{Data.}} </li> #}
            </ul>

            <ul>
                <li> Bikes available</li>
                <li id="statVariable"> {{Data.available_bikes}}</li>

            </ul>

            <ul>
                <li> Stands available</li>
                <li id="statVariable"> Data.available_stands</li>
            </ul>

            <div id="piecharts">Piecharts</div>

        </div>



        <div id="rightHeader">
            <p>Address</p>
            <h3>Historical data</h3>

            <div id="graph">
                <noscript>You need JavaScript enabled to view this item</noscript>
                <div id="historical-graph" width="800" height="800"></div>
            </div>
        </div>
    </div>
    <script>
    BikesModule.getStationHistoricalInformation({{ Data.number }}, null, function(err, response){
        // var ctx = document.getElementById("historical-graph").getContext("2d");

        var availableBikes = response.map(function(day){
            return day.available_bikes;
        });

        var availableBikeStands = response.map(function(day) {
            return day.available_bike_stands;
        });

        google.charts.load('current', {'packages':['bar']});
          google.charts.setOnLoadCallback(drawStuff);

          function drawStuff() {
            var data = new google.visualization.arrayToDataTable([
              ['Day', 'Available Bikes (average)', 'Available Bike Stands (average)'],
              ['Monday', availableBikes[0], availableBikeStands[0]],
              ['Tuesday', availableBikes[1], availableBikeStands[1]],
              ['Wednesday', availableBikes[2], availableBikeStands[2]],
              ['Thursday', availableBikes[3], availableBikeStands[3]],
              ['Friday', availableBikes[4], availableBikeStands[4]],
              ['Saturday', availableBikes[5], availableBikeStands[5]],
              ['Sunday', availableBikes[6], availableBikeStands[6]],
            ]);

            var options = {
              width: 800,
              chart: {
                title: 'Bike and bike stand availability',
              },
              bars: 'horizontal', // Required for Material Bar Charts.
              series: {
                0: { axis: 'Available Bikes' }, // Bind series 0 to an axis named 'distance'.
                1: { axis: 'Available Bike Stands' } // Bind series 1 to an axis named 'brightness'.
              },
              axes: {
                x: {
                  distance: {label: 'parsecs'}, // Bottom x-axis.
                  brightness: {side: 'top', label: 'apparent magnitude'} // Top x-axis.
                }
              }
            };

          var chart = new google.charts.Bar(document.getElementById('historical-graph'));
          chart.draw(data, options);
        };


    });
    </script>
</body>

</html>